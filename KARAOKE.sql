CREATE DATABASE KARAOKE1
GO
USE KARAOKE1
GO
CREATE TABLE KHACHHANG1(
MaKH varchar(10) NOT NULL PRIMARY KEY,
TenKH nvarchar(50) NOT NULL,
DiaChi nvarchar(50),
SoDT int,
MaSoThue int,
)
GO
 CREATE TABLE PHONG1(
 MaPhong varchar(30) NOT NULL PRIMARY KEY,
 SoKhachToiDa int,
 TrangThai nvarchar(40),
 MoTa nvarchar(50),
 )
 GO
 
 CREATE TABLE DICHVU1(
 MaDV varchar(30) NOT NULL PRIMARY KEY,
 TenDV nvarchar(40),
 DonViTinh nvarchar(30),
 DonGia int,
 )
 GO
 CREATE TABLE MUCIENGIO1(
 MaTienGio varchar(10)NOT NULL PRIMARY KEY,
 DonGia int,
 MoTa nvarchar(50),
 )
 GO
 CREATE TABLE HOADON1(
 MaHD varchar(20)NOT NULL PRIMARY KEY,
 MaKH varchar(10),
 MaPhong varchar(30),
 MaTienGio varchar(10),
 ThoiGianBatDauSD datetime,
 ThoiGianKetThucSD datetime,
 TrangThaiHD nvarchar(50),
 )
 GO
 CREATE TABLE CHITIET_SUDUNGDV1(
 MaHD varchar(20) NOT NULL,
 MaDV varchar(30) NOT NULL,
 SoLuong int,
 PRIMARY KEY (MaHD, MaDV),
 )
 GO
 INSERT INTO KHACHHANG1 VALUES('KH001','Tran Van Nam','Hai Chau','0905123456','12345678');
 INSERT INTO KHACHHANG1 VALUES('KH002','Nguyen Mai Anh','Lien Chieu','0905123457','12345679');
 INSERT INTO KHACHHANG1 VALUES ('KH003','Phan Hoai Lan Khue','Hoa Vang','0905123458','12345680');
 INSERT INTO KHACHHANG1 VALUES ('KH004','Nguyen Hoai Nguyen','Hoa Cam','0905123459','12345681');
 INSERT INTO KHACHHANG1 VALUES ('KH005','Le Truong Ngoc Anh','Hai Chau','0905123460','12345682');
 INSERT INTO KHACHHANG1 VALUES ('KH006','Ho Hoai Anh','Hai Chau','0905123461','12345683');
 INSERT INTO KHACHHANG1 VALUES ('KH007','Pham Thi Huong','Son Tra','0905123462','12345684');
 INSERT INTO KHACHHANG1 VALUES ('KH008','Chau Trinh Tri','Hai Chau','0905123463','12345685');
 INSERT INTO KHACHHANG1 VALUES ('KH009','PHan Nhu Thao','Hoa Khanh','0905123464','12345686');
 INSERT INTO KHACHHANG1 VALUES ('KH010','Tran Thi To Tam','Son Tra','0905123465','12345687');
 INSERT INTO PHONG1 VALUES ('VIP01','5','Duoc su dung','phong vip');
 INSERT INTO PHONG1 VALUES ('P02','10','Duoc su dung','phong binh thuong');
 INSERT INTO PHONG1 VALUES ('P03','15','Duoc su dung','phong binh thuong');
 INSERT INTO PHONG1 VALUES ('VIP04','20','Duoc su dung','phong vip');
 INSERT INTO PHONG1 VALUES ('P05','25','Duoc su dung','phong binh thuong');
 INSERT INTO PHONG1 VALUES ('P06','30','Duoc su dung','phong binh thuong');
 INSERT INTO PHONG1 VALUES ('VIP07','35','Duoc su dung','phong vip');
 INSERT INTO PHONG1 VALUES ('P08','40','Duoc su dung','phong binh thuong');
 INSERT INTO PHONG1 VALUES ('VIP09','45','Duoc su dung','phong vip');
 INSERT INTO PHONG1 VALUES ('P10','50','Duoc su dung','phong binh thuong');
 INSERT INTO DICHVU1 VALUES ('DV01','Hat Dua','Bao','5000');
 INSERT INTO DICHVU1 VALUES ('DV02','Trai Cay','Dia','30000');
 INSERT INTO DICHVU1 VALUES ('DV03','Bia','Lon','35000');
 INSERT INTO DICHVU1 VALUES ('DV04','Nuoc Ngot','Chai','10000');
 INSERT INTO DICHVU1 VALUES ('DV05','Ruou','Chai','200000');
INSERT INTO MUCIENGIO1 VALUES ('MT01','60000','Ap dung tu 6 gio den 17 gio');
INSERT INTO MUCIENGIO1 VALUES ('MT02','80000','Ap dung sau 17 gio den 22 gio');
INSERT INTO MUCIENGIO1 VALUES ('MT03','100000','Ap dung tu sao 22 gio den 6 gio sang');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD001','DV01','5');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD002','DV01','8');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD002','DV02','5');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD002','DV03','2');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD003','DV04','1');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD003','DV05','6');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD004','DV01','5');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD005','DV02','3');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD005','DV03','10');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD005','DV04','2');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD006','DV01','5');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD007','DV03','8');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD007','DV04','10');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD007','DV05','4');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD013','DV02','9');
INSERT INTO CHITIET_SUDUNGDV1 VALUES ('HD011','DV02','8');
INSERT INTO HOADON1 VALUES ('HD001','KH001','VIP01','MT01','11/20/2015 8:15','11/20/2015 12:30','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD002','KD002','P02','MT01','12/12/2015 13:10','12/12/2015 17:20','Chua thanh toan');
INSERT INTO HOADON1 VALUES ('HD003','KH003','P02','MT01','10/15/2014 12:12','10/15/2014 16:30','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD004','KH003','VIP01','MT02','9/20/2015 18:30','9/20/2015 21:00','Chua thanh toan');
INSERT INTO HOADON1 VALUES ('HD005','KH001','P03','MT02','11/25/2014 20:00','11/25/2014 21:45','Thanh toan mot phan');
INSERT INTO HOADON1 VALUES ('HD006','KH002','VIP01','MT01','9/12/2014 9:20','9/12/2014 10:45','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD007','KH006','P05','MT03','12/22/2014 11:00','12/22/2014  14:20','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD008','KH007','VIP04','MT02','8/23/2014 20:10','8/23/2014 22:00','Chua thanh toan');
INSERT INTO HOADON1 VALUES ('HD009','KH006','P05','MT03','12/20/2015 22:30','12/21/2015 1;15','Chua thanh toan');
INSERT INTO HOADON1 VALUES ('HD010','KH005','VIP01','MT03','10/10/2015 1:30','10/10/2015 3:15','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD011','KH004','VIP07','MT03','12/25/2015 22:15','12/26/2015 2:00','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD012','KH008','P06','MT03','7/25/2014 23:45','7/26/2015 2:15','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD013','KH007','VIP07','MT02','8/21/2015 18:15','8/21/2015 20:45','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD014','KH004','P06','MT02','12/31/2015 19:12','12/31/2015 21:15','Thanh toan mot phan');
INSERT INTO HOADON1 VALUES ('HD015','KH001','P06','MT01','6/24/2014 13:00','6/24/2014 13:15','Thanh toan mot phan');
INSERT INTO HOADON1 VALUES ('HD016','KH003','P08','MT01','5/12/2014 8:00','5/12/2014 10:45','Thanh toan mot phan');
INSERT INTO HOADON1 VALUES ('HD017','KH003','VIP09','MT01','11/20/2015 12:15','11/20/2015 14:20','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD018','KH001','P10','MT01','4/12/2015 14:45','4/12/2015 16:45','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD019','KH002','VIP09','MT03','11/12/2015 22;12','11/13/2015 2:00','Da thanh toan');
INSERT INTO HOADON1 VALUES ('HD020','KH004','VIP09','MT03','2/25/2014 1:15','2/25/2014 4:15','Chua thanh toan');
SELECT*FROM HOADON1

GO
SELECT*FROM PHONG1
WHERE SoKhachToiDa <20
--cau4
SELECT*FROM DICHVU1
WHERE DonViTinh='Chai' AND DonGia<20000
(
  SELECT*FROM DICHVU1
  WHERE DonViTinh='Lon' AND DonGia>30000
 )

 --cau5
 SELECT*FROM PHONG
 WHERE MaPhong like '%VIP%'
 --Cau6
 SELECT*FROM DICHVU
 ORDER BY DonGia DESC
 --cau7
 SELECT COUNT(*)FROM HOADON
 WHERE TrangThaiHD like N'Chua thanh toan' 
 SELECT COUNT(*) FROM HOADON
 WHERE Th
 --cau 8
 SELECT DISTINCT DiaChi FROM KHACHHANG
 -- dem so luong cac dia chi khac nhau
 SELECT COUNT(DISTINCT DiaChi) FROM KHACHHANG
 --cau 9